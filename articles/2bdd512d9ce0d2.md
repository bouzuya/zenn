---
emoji: "🦁"
publication_name: "doctormate"
published: true
published_at: 2026-04-20 12:00
title: "non_exhaustive でフィールド追加に備える"
topics: ["rust"]
type: "tech"
---

[以前の記事](https://zenn.dev/doctormate/articles/e0e241712f5cad)ではフィールドを追加したときコンパイルエラーになるような詰め替え時のパターンを提案しました。

今回は逆にフィールドを追加したときコンパイルエラーにならないようにするための属性 non_exhaustive を紹介します。

## non_exhaustive 属性とは

TODO

enum で定義した Error の variant や struct の field など、将来的に増える可能性がある場合、網羅できていないことを non_exhaustive で示すことができます。

non_exhaustive 属性を設定すると、フィールドを指定して構造体を構築 (例: `S { f1 }`) できなくなったり、パターンマッチで `..` (enum なら `_ => ...`) を指定しないといけなくなります。前回の記事で `..` を指定してはいけないと書きましたが、その使用を必須にする属性というわけです。

注意として crate 内では効果がありません。他の crate から参照したときにはじめて効果が出ます。

## コード例

<https://github.com/bouzuya/rust-examples/tree/f3f205895d801bb7345d5f995de934410943e260/non_exhaustive>

TODO

## おわりに

TODO

## 参考

- The non_exhaustive attribute - Type System - The Rust Reference <https://doc.rust-lang.org/reference/attributes/type_system.html#the-non_exhaustive-attribute>
