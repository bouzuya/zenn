---
emoji: "📝"
publication_name: "doctormate"
published: true
published_at: 2025-10-15 12:00
title: "git diff --stat A...B のススメ"
topics: ["git"]
type: "tech"
---

## 『 Looks Good To Me 』読書会を通じて知った「適切な PR サイズ」

ドクターメイト株式会社では読書会を実施しています。最近は[『 Looks Good To Me 』](https://www.shuwasystem.co.jp/book/9784798071442.html)を読みました。コードレビューについてのアレコレが書かれています。詳細はぜひ読んでみてほしいです。

個人的に『 Looks Good To Me 』で印象的だったもののひとつが「適切な Pull Request サイズ」です。

Pull Request が大きいと良くないというのはもちろん感覚的・経験則的に知っています。ただ、具体的な値を意識したことはありませんでした。

『 Looks Good To Me 』では、これについて具体的な値として「変更ファイル数 20 未満」、「コードの変更は 500 行以下」が挙げられています。

この値が絶対ということはないと思うのですが、読書会を通じて、チームでひとつの目安であるという共通認識ができました。

## 適切な Pull Request サイズの確認方法

### GitHub の Pull Request の画面

これは例えば GitHub の Pull Request の画面で確認できます。

![](https://private-user-images.githubusercontent.com/1221346/500147856-b0f734b8-a02d-422e-923d-d6bf7b3fab7e.png?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NjAxODc4NDcsIm5iZiI6MTc2MDE4NzU0NywicGF0aCI6Ii8xMjIxMzQ2LzUwMDE0Nzg1Ni1iMGY3MzRiOC1hMDJkLTQyMmUtOTIzZC1kNmJmN2IzZmFiN2UucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MTAxMSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTEwMTFUMTI1OTA3WiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9OTJlNDBhNTk2NTA2ODZiM2RjZGJkMDg2ZGYyY2U3Y2ZlNTc4ZWJmYWEwM2I3YTE2NTg0MGU1Yzk3YjNiNjAwMiZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.FGV7bqgQUGYCR5up_MFKE4EdtncjGsqCDBgd5a4BMmw)

ただ Pull Request をつくってから「あ、大きすぎた」ではちょっと遅いので、もうすこし早い段階で確認したいです。

### git diff --stat A...B のススメ

そこで今日の本題 `git diff --stat A...B` です。

Pull Request をつくる前に、作業中、コミットをつくる際に確認する想定です。

`git diff --stat A...B` だと↓のようになります。 `A` は `main` など分岐元ブランチ (やコミット) です。 `B` は省略すれば直近のコミットです。 `...` なので共通の直近のコミットからの差分が表示されます。

```console
$ git diff --stat master...
 README.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
```

`--stat` ではファイルごとのものが表示されます。

`git diff --shortstat A...B` という指定もあります。こちらはファイルごとのものは表示されません。最後の 1 行のみです。

```console
$ git diff --shortstat master...
 1 file changed, 1 insertion(+), 1 deletion(-)
```

ファイルが多いときはこちらが便利かもしれません。

## おわりに

適切な Pull Request サイズを確認するのに便利な `git diff --stat A...B` というコマンドを紹介しました。

レビュアーに優しい Pull Request を心がけたいですね。

## 参考

- <https://git-scm.com/docs/git-diff>
- <https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/about-comparing-branches-in-pull-requests#three-dot-and-two-dot-git-diff-comparisons>
